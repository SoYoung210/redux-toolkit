<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-130598673-3","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>

<title data-react-helmet="true">중급 튜토리얼 | Redux Toolkit</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"><meta data-react-helmet="true" property="og:title" content="Redux Toolkit"><meta data-react-helmet="true" property="og:image" content="https://SoYoung210.github.io/redux-toolkit/img/redux-logo-landscape.png"><meta data-react-helmet="true" property="twitter:image" content="https://SoYoung210.github.io/redux-toolkit/img/redux-logo-landscape.png"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for Redux Toolkit"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" name="description" content="# 중급 튜토리얼: Redux Toolkit in Action"><meta data-react-helmet="true" property="og:description" content="# 중급 튜토리얼: Redux Toolkit in Action"><meta data-react-helmet="true" property="og:url" content="https://SoYoung210.github.io/redux-toolkit/tutorials/intermediate-tutorial">

<link data-react-helmet="true" rel="shortcut icon" href="/redux-toolkit/img/favicon/favicon.ico">


<link rel="stylesheet" href="/redux-toolkit/styles.86dcca96.css">


<link rel="preload" href="/redux-toolkit/styles.65c09200.js" as="script">

<link rel="preload" href="/redux-toolkit/runtime~main.0722f1cd.js" as="script">

<link rel="preload" href="/redux-toolkit/main.bae73ed5.js" as="script">

<link rel="preload" href="/redux-toolkit/1.188bb098.js" as="script">

<link rel="preload" href="/redux-toolkit/2.46003221.js" as="script">

<link rel="preload" href="/redux-toolkit/26.f1fc65f0.js" as="script">

<link rel="preload" href="/redux-toolkit/b769c63f.a0c93f25.js" as="script">

<link rel="preload" href="/redux-toolkit/17896441.dec4baf3.js" as="script">

<link rel="preload" href="/redux-toolkit/b7bc07b1.97f43881.js" as="script">

</head>
<body>

<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/redux-toolkit/"><img class="navbar__logo" src="/redux-toolkit/img/redux.svg" alt="Redux Logo"><strong>Redux Toolkit</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/redux-toolkit/introduction/quick-start">Quick Start</a><a class="navbar__item navbar__link" href="/redux-toolkit/api/configureStore">API</a><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://github.com/reduxjs/redux-toolkit">GitHub</a><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/redux-toolkit/"><img class="navbar__logo" src="/redux-toolkit/img/redux.svg" alt="Redux Logo"><strong>Redux Toolkit</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/redux-toolkit/introduction/quick-start">Quick Start</a></li><li class="menu__list-item"><a class="menu__link" href="/redux-toolkit/api/configureStore">API</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://github.com/reduxjs/redux-toolkit">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="sidebarLogo_3ono"><img src="/redux-toolkit/img/redux.svg" alt="Redux Logo"><strong>Redux Toolkit</strong></div><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/redux-toolkit/introduction/quick-start">Quick Start</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Tutorials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/redux-toolkit/tutorials/basic-tutorial">기본 튜토리얼</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/redux-toolkit/tutorials/intermediate-tutorial">중급 튜토리얼</a></li><li class="menu__list-item"><a class="menu__link" href="/redux-toolkit/tutorials/advanced-tutorial">Advanced Tutorial</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Using Redux Toolkit</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/redux-toolkit/usage/usage-guide">Usage Guide</a></li><li class="menu__list-item"><a class="menu__link" href="/redux-toolkit/usage/usage-with-typescript">Usage With TypeScript</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">API Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/redux-toolkit/api/configureStore">configureStore</a></li><li class="menu__list-item"><a class="menu__link" href="/redux-toolkit/api/getDefaultMiddleware">getDefaultMiddleware</a></li><li class="menu__list-item"><a class="menu__link" href="/redux-toolkit/api/createReducer">createReducer</a></li><li class="menu__list-item"><a class="menu__link" href="/redux-toolkit/api/createAction">createAction</a></li><li class="menu__list-item"><a class="menu__link" href="/redux-toolkit/api/createSlice">createSlice</a></li><li class="menu__list-item"><a class="menu__link" href="/redux-toolkit/api/createSelector">createSelector</a></li><li class="menu__list-item"><a class="menu__link" href="/redux-toolkit/api/createAsyncThunk">createAsyncThunk</a></li><li class="menu__list-item"><a class="menu__link" href="/redux-toolkit/api/createEntityAdapter">createEntityAdapter</a></li><li class="menu__list-item"><a class="menu__link" href="/redux-toolkit/api/other-exports">Other Exports</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="중급-튜토리얼-redux-toolkit-in-action"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#중급-튜토리얼-redux-toolkit-in-action" title="Direct link to heading">#</a>중급 튜토리얼: Redux Toolkit in Action</h1><p><a href="/redux-toolkit/tutorials/basic-tutorial">기본 튜토리얼</a>에서는 Redux Toolkit에 포함 된 주요 API의 기능과 간단한 예제를 다뤄보았고, React, NPM, Webpack등의 빌드 도구를 사용하지 않고 HTML 페이지의 일반 JS 스크립트 태그에서 Redux 및 RTK(Redux Toolkit)을 사용할 수 있다는 것을 알게 되었습니다.</p><p>이번 튜토리얼에서는 RTK를 React 앱에서 어떻게 사용해보는지 소개합니다. 구체적으로, <a href="https://redux.js.org/introduction/examples#todos">Redux &quot;todos&quot; 예제</a>를 RTK로 구현해볼 것입니다.</p><p>이번 튜토리얼에서 다루게 될 개념들 입니다:</p><ul><li>&quot;Redux&quot;코드를 어떻게 RTK로 바꾸는지</li><li>RTK를 React+Redux 앱에서 어떻게 사용하는지</li><li>RTK의 강력한 기능 중 하나인 &#x27;Redux 코드를 어떻게 간결하게 만드는 방법&#x27;</li></ul><p>또한, RTK에 국한된 것은 아니지만 React-Redux 코드를 개선할 수 있는 몇 가지 방법을 살펴보겠습니다.</p><p>이 튜토리얼에서 다루는 모든 코드는 <a href="https://github.com/reduxjs/rtk-convert-todos-example">github.com/reduxjs/rtk-convert-todos-example</a>에서 확인하실 수 있습니다.
튜토리얼은 이 저장소의 커밋 히스토리를 따라가며 진행되고, 개별 커밋에 대한 링크는 다음과 같이 블록으로 강조 표시 됩니다.</p><blockquote><ul><li>Commit message here</li></ul></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="redux-todos-예제-리뷰"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#redux-todos-예제-리뷰" title="Direct link to heading">#</a>Redux Todos 예제 리뷰</h2><p><a href="https://github.com/reduxjs/redux/tree/9c9a4d2a1c62c9dbddcbb05488f8bd77d24c81de/examples/todos/src">현재 &quot;todos&quot; 예제 코드</a>를 살펴보면 몇 가지 사항을 확인할 수 있습니다:</p><ul><li><a href="https://github.com/reduxjs/redux/blob/9c9a4d2a1c62c9dbddcbb05488f8bd77d24c81de/examples/todos/src/reducers/todos.js"><code>todos</code> reducer 함수</a>는 중첩된 JS 객체와 배열을 &quot;수동으로&quot; 복사하며 불변성을 관리하고 있습니다.</li><li><a href="https://github.com/reduxjs/redux/blob/9c9a4d2a1c62c9dbddcbb05488f8bd77d24c81de/examples/todos/src/actions/index.js"><code>actions</code> 파일</a>에는 직접 작성한 액션 생성자 함수가 있으며 reducer파일과 action파일에서 중복으로 사용되는 액션 type문자열이 있습니다.</li><li>예제의 코드는 <code>actions</code> 와 <code>reducers</code>를 각각 별도의 파일로 가지고 있으며, 이를 <a href="https://redux.js.org/faq/code-structure#what-should-my-file-structure-look-like-how-should-i-group-my-action-creators-and-reducers-in-my-project-where-should-my-selectors-go">&quot;폴더 별&quot;로 분리하여</a>관리 합니다.</li><li>React컴포넌트는 <a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0">&quot;container/presentational&quot; 패턴</a>으로 작성되며, 여기서 &quot;presentational&quot;컴포넌트는와 <a href="https://github.com/reduxjs/redux/tree/9c9a4d2a1c62c9dbddcbb05488f8bd77d24c81de/examples/todos/src/containers">Redux &quot;container&quot; 연결에 대한 정의는 다른 폴더에 있습니다.</a></li><li>일부 코드는 Redux &quot;best practice&quot;를 따르지 않습니다. 이 튜토리얼을 진행하면서 몇 가지 구체적인 예시를 살펴 보겠습니다.</li></ul><p>이 예제는 작은 앱입니다. 이는 실제로 React와 Redux를 어떻게 함께 쓸 수 있는 지에 대한 기본사항을 설명하기 위한 것이며, 실제 프로덕션 앱에 적용시 이 튜토리얼의 방식으 &quot;맞는 방법&quot;으로 사용할 필요는 없습니다. 대부분의 개발자가 문서와 예제에서 볼 수 있는 패턴을 사용하는데, 이는 개선의 여지가 있습니다.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="초기-단계"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#초기-단계" title="Direct link to heading">#</a>초기 단계</h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="project에-redux-toolkit-추가하기"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#project에-redux-toolkit-추가하기" title="Direct link to heading">#</a>Project에 Redux Toolkit 추가하기</h3><p>todos예제는 Redux저장소에 있기 때문에 Redux &quot;todos&quot; 소스 코드를 새로운 Create-React-App 프로젝트에 복사하고 Prettier를 추가하여 코드의 형식이 일관되게 유지하도록 합니다. <code>/src</code>폴더에서 시작하는 &quot;절대경로 import&quot;를 사용할 수 있도록 하는 <a href="https://code.visualstudio.com/docs/languages/jsconfig">jsconfig.json</a>파일도 있습니다.</p><blockquote><ul><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/a8e0a9a9d77b9dcd9e881079e7cca449084ca7b1">Initial commit</a>.</li><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/b866e205b9ebece84367f11d2faabc557bd08e23">Add jsconfig.json to support absolute imports</a></li></ul></blockquote><p>기본 튜토리얼에서는 Redux Toolkit을 개별 스크립트로 연결했습니다. 그러나 일반적인 앱에서는 RTK를 package dependency로 추가해야 합니다. 이는 NPM 또는 Yarn패키지 관리자를 사용하여 수행할 수 있습니다:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-bash codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#778090"># NPM을 사용할 경우:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token function" style="color:#E6D874">npm</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">install</span><span class="token plain"> @reduxjs/toolkit</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#778090"># Yarn을 사용할 경우:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token function" style="color:#E6D874">yarn</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">add</span><span class="token plain"> @reduxjs/toolkit</span></div></code></pre></div><p>설치가 완료되면, <code>package.json</code> 파일과 &quot;lock file&quot;을 패키지 관리자에 추가하고 커밋해야 합니다.(NPM: <code>package-lock.json</code>, YARN: <code>yarn.lock</code>).</p><blockquote><ul><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/c3f47aeaecf855561e4db9d452b928f1b8b6c016">Add Redux Toolkit</a></li></ul></blockquote><p>이 작업이 완료되면, 이제 코드를 작성할 수 있습니다.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="store에서-configurestore를-사용하도록-수정"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#store에서-configurestore를-사용하도록-수정" title="Direct link to heading">#</a>Store에서 <code>configureStore</code>를 사용하도록 수정</h3><p>&quot;카운터&quot;예제와 마찬가지로 일반 Redux <code>createStore</code>기능을 RTK의 <code>configureStore</code>로 변경할 수 있습니다. 이 과정에서 Redux DevTools 확장 프로그램이 자동으로 설정됩니다.</p><p>이 과정에서의 변경은 간단합니다. <code>src/index.js</code>에서 <code>createStore</code>대신 <code>configureStore</code>를 사용하도록 수정하면 됩니다. <code>configureStore</code>는 옵션 객체를 정확한 key와 함께 넘겨야 하므로 <code>rootReducer</code>를 첫 번째 매개변수로 전달하는 대신 <code>reducer</code>라는 key의 value로 전달합니다.</p><blockquote><ul><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/cdfc15edbd82beda9ef0521aa191574b6cc7695a">Convert store setup to use configureStore</a></li></ul></blockquote><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-diff codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">import React from &quot;react&quot;;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">import { render } from &quot;react-dom&quot;;</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">-import { createStore } from &quot;redux&quot;;</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+import { configureStore } from &quot;@reduxjs/toolkit&quot;;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain">import { Provider } from &quot;react-redux&quot;;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">import App from &quot;./components/App&quot;;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">import rootReducer from &quot;./reducers&quot;;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">- const store = createStore(rootReducer);</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+ const store = configureStore({</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+   reducer: rootReducer,</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+});</span></div></code></pre></div><p><strong>여전히 이전과 동일한 root reducer를 사용하고 있으며 Redux Store는변경 중입니다. 변경된 것은 Store를 생성하는 과정에서 개발이 편리하도록 도구(역주: Redux Dev Tools)가 자동으로 설정된 것 뿐입니다.</strong></p><p><a href="https://github.com/zalmoxisus/redux-devtools-extension">Redux DevTools 브라우저 확장프로그램</a>이 설치되어 있는 경우 개발자 모드에서 store의 현재 상태를 확인할 수 있습니다.</p><p><img src="/assets/tutorials/intermediate/int-tut-01-redux-devtools.png" alt="Redux DevTools Extension screenshot showing initial state"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="todo-slice만들기"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#todo-slice만들기" title="Direct link to heading">#</a>Todo Slice만들기</h2><p>todo app을 다시 만드는 첫 번째 단계는 todo 로직을 새로운 &quot;slice&quot;로 변환하는 것입니다.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="slices-이해하기"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#slices-이해하기" title="Direct link to heading">#</a>Slices 이해하기</h3><p>현재, todos코드는 두 부분으로 나뉩니다. 리듀서 로직은 <code>reducers/todo.js</code>에 있고, action creator들은 <code>actions.index.js</code>에 있습니다. 더 규모가 큰 <code>constants/todo.js</code>와 같은 파일에서 액션type을 관리하고 두 곳에서 공통적으로 사용합니다.</p><p>RTK의 <a href="/redux-toolkit/api/createReducer"><code>createReducer</code></a>를 사용하면 해당 로직을 한 곳에서 관리할 수 있습니다. 내부적으로 <code>createReducer</code>와 <code>createAction</code>을 사용하므로 <strong>대부분의 앱에서는 이 두 함수를 직접 사용할 필요 없이 <code>createSlice</code>만 사용하면 됩니다.</strong></p><p>&#x27;slice&#x27;가 무엇인지 궁금할 것입니다. 일반적인 Redux앱은 상태트리의 최상단에 JS객체를 가지고 있으며, 이 객체는  <a href="https://redux.js.org/api/combinereducers"><code>combineReducers</code> 함수</a>에서 여러 reducer들을 하나로 결합한 &quot;root reducer&quot;입니다.<strong>이 객체에서 key/value로 구분되는 object를 &quot;slice&quot;라고 하며, slice의 상태를 업데이트 하는 리듀서를 <a href="https://redux.js.org/recipes/structuring-reducers/splitting-reducer-logic">&quot;slice reducer&quot;</a>라고 합니다.</strong>
이 앱에서 루트 리듀서는 다음과 같습니다.:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-js codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> todos </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;./todos&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> visibilityFilter </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;./visibilityFilter&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">default</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">combineReducers</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  todos</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  visibilityFilter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></code></pre></div><p>따라서, <code>combineReducers</code>로 결합된 상태는 <code>{todos: [], visibilityFilter: &quot;SHOW_ALL&quot;}</code>와 같습니다. <code>state.todos</code>는 &quot;slice&quot;이고, <code>todos</code>reducer는 &quot;slice reducer&quot;입니다.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="기존의-todos-reducer"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#기존의-todos-reducer" title="Direct link to heading">#</a>기존의 Todos Reducer</h3><p>기존의 todos reducer는 다음과 같습니다:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-js codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">todos</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state </span><span class="token parameter operator" style="color:#F8F8F2">=</span><span class="token parameter"> </span><span class="token parameter punctuation" style="color:#F8F8F2">[</span><span class="token parameter punctuation" style="color:#F8F8F2">]</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">case</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;ADD_TODO&#x27;</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token spread operator" style="color:#F8F8F2">...</span><span class="token plain">state</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          id</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">id</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          text</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">text</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          completed</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token boolean" style="color:#AE81FF">false</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">case</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;TOGGLE_TODO&#x27;</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">map</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">todo</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        todo</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">id</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">id</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">?</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> </span><span class="token spread operator" style="color:#F8F8F2">...</span><span class="token plain">todo</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> completed</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">!</span><span class="token plain">todo</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">completed</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> todo</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword module" style="color:#F92672">default</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">return</span><span class="token plain"> state</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">default</span><span class="token plain"> todos</span></div></code></pre></div><p>위 경우 세 가지 케이스를 처리하고 있습니다.:</p><ul><li>기존의 <code>state</code>배열을 복사하고 마지막에 새로운 아이템을 추가합니다.</li><li><code>state.map()</code>을 사용하여 기존 배열을 복사하여 할일 항목을 toggle처리하고 업데이트해야 하는 아이템을 복사 및 교체하고, 업데이트가 필요하지 않은 항목들은 그대로 반환합니다.</li><li>기존 상태를 반홚여 다른 모든 action에 응답합니다.</li></ul><p><code>[]</code>값으로 상태를 초기화하고 reducer를 default로 export합니다.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="slice-reducer작성"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#slice-reducer작성" title="Direct link to heading">#</a>Slice Reducer작성</h3><p>위 작업을 <code>createSlice</code>로 더 간단하게 수행할 수 있습니다.</p><p>제일 먼저, <code>/features/todos/todosSlice.js</code>에 새 파일을 추가합니다. 폴더와 파일을 구성하는 방식은 중요하지 않지만, 대부분의 앱에서 <a href="https://redux.js.org/faq/code-structure#what-should-my-file-structure-look-like-how-should-i-group-my-action-creators-and-reducers-in-my-project-where-should-my-selectors-go">&quot;feature folder&quot; 접근방식</a>이 효과적입니다. 파일 이름은 개발자의 재량에 달려있지만, <code>someFeatureSlice.js</code>규칙이 합리적입니다.</p><p>이 파일에서는, 아래와 같은 로직을 추가하겠습니다.:</p><blockquote><ul><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/48ce059dbb0fce1b961631821534fbcb766d3471">Add an initial todos slice</a></li></ul></blockquote><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-js codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> createSlice </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;@reduxjs/toolkit&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> todosSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  name</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;todos&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  initialState</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  reducers</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">addTodo</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> id</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> text </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">push</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> id</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> completed</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token boolean" style="color:#AE81FF">false</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">toggleTodo</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> todo </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">find</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">todo</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> todo</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">id</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">todo</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        todo</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">completed</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">!</span><span class="token plain">todo</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">completed</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> addTodo</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> toggleTodo </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> todosSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">actions</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">default</span><span class="token plain"> todosSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">reducer</span></div></code></pre></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="createslice-옵션"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#createslice-옵션" title="Direct link to heading">#</a><code>createSlice</code> 옵션</h4><p>어떤 옵션들이 있는지 살펴봅니다.:</p><ul><li><code>createSlice</code>는 다음 옵션과 함께 option 객체를 인자로 사용합니다. takes an options object as its argument, with these options:<ul><li><code>name</code>: 생성 된 action types를 생성하기 위해 사용되는 prefix</li><li><code>initialState</code>: reducer의 초기 상태</li><li><code>reducers</code>: key는 action type문자열이 되고 함수는 해당 액션이 dispatch될때 실행될 reducer입니다.(<code>switch-case</code>문과 비슷해서 <a href="https://redux.js.org/recipes/structuring-reducers/splitting-reducer-logic">&quot;case reducers&quot;</a>라고도 합니다.)</li></ul></li></ul><p>따라서, <code>&quot;todos/addTodo&quot;</code>액션이 dispatch될 때 <code>addTodo</code>reducer가 수행됩니다.</p><p><code>default</code>핸들러는 없습니다. <code>createSlice</code>에 의해 생성된 리듀서는 현재 dispatch된 액션이 아닌 다른 액션들에 대해 자동으로 현재 상태를 반환하도록 처리되어 있기 때문에, 직접 핸들링해주지 않아도 됩니다.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="mutable-업데이트-로직"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#mutable-업데이트-로직" title="Direct link to heading">#</a>&quot;Mutable&quot; 업데이트 로직</h4><p><code>addTodo</code>리듀서는 <code>state.push()</code>를 호출합니다. 일반적으로 이런 방식은 <a href="https://doesitmutate.xyz/#push"><code>array.push()</code>함수가 기존 배열을 변형하기 때문에</a> 좋은 방법이 아니고, <strong><a href="https://redux.js.org/basics/reducers#handling-actions">Redux에서는 reducers에서 절대 state를 직접 변경하지 않아야 합니다!</a></strong>.</p><p>그러나, <code>createSlice</code>와 <code>createReducer</code>는 <a href="https://github.com/immerjs/immer">Immer library의 <code>produce</code></a>로 래핑합니다. 이것은 이 함수를 사용하는 개발자는 리듀서 내부의 상태를 &quot;변형하는&quot;코드를 작성할수 있으며, Immer는 상태를 안전하게 불변하게 다룰수 있도록 처리해줍니다.</p><p>마찬가지로, <code>toggleTodo</code>는 배열을 순회하거나 일치하는 todo객체를 복사하지 않습니다. 대신, 일치하는 todo객체를 찾은 다음 <code>todo.completed = !todo.completed</code>코드로 변경합니다. Immer는 이 객체가 업데이트 된 것을 감지하고 todo객체와 이를 포함하는 배열을 모두 복사합니다.</p><p>일반적인 불변성 관리는 추가 복사가 모두 발생하여 실제로 수행하려는 작업을 모호하게 하는 경향도 있습니다. 의도가 조금더 명확히 드러나야 합니다: 배열 끝에 항목을 추가하고 todo항목의 필드를 수정하는 것.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="slice함수-내보내기"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#slice함수-내보내기" title="Direct link to heading">#</a>Slice함수 내보내기</h4><p><code>createSlice</code>는 다음과 같은 객체를 반환합니다.:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-js codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  name</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;todos&quot;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token function-variable function" style="color:#E6D874">reducer</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> newState</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  actions</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function-variable function" style="color:#E6D874">addTodo</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">payload</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">type</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;todos/addTodo&quot;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function-variable function" style="color:#E6D874">toggleTodo</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">payload</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">type</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;todos/toggleTodo&quot;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  caseReducers</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function-variable function" style="color:#E6D874">addTodo</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> newState</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function-variable function" style="color:#E6D874">toggleTodo</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> newState</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></code></pre></div><p><strong>각 리듀서마다 적절한 action생성자와 action type을 자동으로 생성하므로 직접 작성하지 않아도 됩니다!</strong></p><p>액션 크리에이터와 reducer를 다른 파일에 사용하기 위해 slice object를 export해야 합니다. <a href="https://github.com/erikras/ducks-modular-redux">&quot;ducks&quot; 패턴</a>이라고 불리는 Redex 커뮤니티 코드 규칙을 사용할 수 있습니다. 간단히 말해서, 모든 액션 크리에이터와 reducer를 한 파일에 넣고, 액션 크리에이터와 reducer를 export 해야 합니다.</p><p><code>createSlice</code> 덕분에, 우리는 이미 액션 액션 크리에이터와 reducer를 한 파일에 가지고 있습니다. 우리가 해야 할 일은 그것들을 별도로 export하는 것이고, todos 슬라이스 파일은 이제 일반적인 &quot;ducks&quot; 패턴과 일치한다.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="action-payloads와-함께-사용하기"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#action-payloads와-함께-사용하기" title="Direct link to heading">#</a>Action Payloads와 함께 사용하기</h4><p>잠시 reducer 로직을 다시 살펴보겠습니다.</p><p>기본적으로 RTK &quot;createAction&quot; 함수는 &quot;payload&quot;라는 하나의 인수만 허용합니다.</p><p><code>action.payload</code>는 그 자체로 특별한 것이 없습니다. Redux는 그 이름을 모르거나 신경 쓰지 않습니다. 그러나 &quot;payload&quot;라는 이름은 <a href="https://github.com/redux-utilities/flux-standard-action">&quot;Flux Standard Actions&quot;</a>라는 또 다른 Redux 커뮤니티 컨벤션에서 유래되었습니다.</p><p>Action에는 일반적으로 &quot;type&quot; 필드와 함께 일부 추가 데이터가 포함되어야 합니다. <code>addTodo</code>의 원래 Redux 코드에는 <code>{type, id, text}</code>처럼 보이는 action 객체가 있습니다. <strong>FSA 규약에 따르면 임의의 이름을 가진 데이터 필드를 action 객체에 직접 포함하기보다는 항상 &#x27;payload&#x27;</strong>라는 필드 안에 데이터를 넣어야 합니다.</p><p>각 액션 유형에 대해 &#x27;payload&#x27;를 무엇으로 하던, 그리고 어떤 코드를 dispatch하던 그 기대에 부합하는 값을 전달해야 한다고 생각하는지를 결정하는 것은 reducer에 달려 있습니다. 하나의 값만 필요한 경우 이 값을 전체 &quot;payload&quot; 값으로 직접 사용할 수 있습니다. 일반적으로 여러 값을 전달해야 합니다. 이 경우 &#x27;payload&#x27;는 해당 값을 포함하는 객체여야 합니다.</p><p>우리의 todos 슬라이스에서 <code>addtodo</code>는 id와 text라는 두 개의 필드가 필요하기 때문에 우리는 그것들을 payload로 객체 안에 넣었습니다. <code>toggleTodo</code>의 경우, 우리가 필요한 유일한 값은 변경되는 할일의<code>id</code>입니다. 우리는 &#x27;페이로드&#x27;를 만들 수는 있지만 항상 &#x27;페이로드&#x27;를 객체로 사용하는 것을 선호하므로 대신 &#x27;action.payload.id&#x27;로 만들었습니다.</p><p>(잠시 살펴보면, action객체 payload가 생성되는 방식을 사용자 정의하는 방법이 있습니다. 이 튜토리얼의 뒷부분에서 살펴보거나 <a href="/redux-toolkit/api/createAction">createAction API 문서</a>에서 설명을 볼 수 있습니다.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="updating-the-todos-tests"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#updating-the-todos-tests" title="Direct link to heading">#</a>Updating the Todos Tests</h3><p>todo reducer에는 테스트 파일이 있습니다. todo Slice로 작동하도록 옮기고 둘 다 동일한 방식으로 작동하는지 확인할 수 있습니다.</p><p>첫 번째 단계는<code>reducers / todos.spec.js</code>를<code>features / todos / todosSlice.spec.js</code>에 복사하고 import 경로를 변경하여 slice 파일에서 reducer를 읽는 것입니다.</p><blockquote><p>-<a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/b603312ddf55899e8a75522d407c40474948ae0b">todoSlice에 테스트 복사</a></p></blockquote><p>완료되면 RTK 작동 방식과 일치하도록 테스트를 업데이트해야합니다.</p><p>첫 번째 문제는 테스트 파일이 <code>&#x27;ADD_TODO&#x27;</code>와 같은 action type을 하드 코딩한다는 것입니다. RTK의 액션 유형은 <code>&#x27;todos / addTodo&#x27;</code>처럼 보입니다. todoSlice에서 액션 생성자를 가져오고 테스트의 액션 상수를<code>addTodo.type</code>으로 대체하여 이를 참조 할 수 있습니다.</p><p>또 다른 문제는 테스트의 액션 객체가<code>{type, id, text}</code>처럼 보이는 반면 RTK는 항상 이러한 추가 값을<code>action.payload</code> 안에 넣는다는 것입니다. 따라서 이에 맞게 테스트 작업을 수정해야합니다.</p><p>(실제로 테스트의 모든 인라인 작업 개체를<code>addTodo ({id : 0, text : &quot;Buy milk&quot;})</code>와 같은 호출로 대체 할 수 있지만 지금은 긴단하게 변경합니다.)</p><blockquote><p>-<a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/39dbbf37bd4c559db956c8291bbd0bf1135546bb">todoSlice로 테스트 이동</a></p></blockquote><p>변경의 예는 다음과 같습니다.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-diff codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-import todos from &#x27;./todosSlice&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+import todos, { addTodo, toggleTodo } from &#x27;./todosSlice&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">// later, in a test:</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token unchanged">  it(&#x27;should handle ADD_TODO&#x27;, () =&gt; {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged">    expect(</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged">      todos([], {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#F92672">-       type: &#x27;ADD_TODO&#x27;,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-       text: &#x27;Run the tests&#x27;,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-       id: 0</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+       type: addTodo.type,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+       payload: {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+         text: &#x27;Run the tests&#x27;,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+         id: 0</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+       }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token unchanged">      })</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged">    ).toEqual([</span></div></code></pre></div><p>변경 후에<code>todosSlice.spec.js</code>의 모든 테스트를 통과해야 새로운 RTK Slice reducer가 원래 작성한 reducer와 정확히 동일하게 작동 함을 보장할 수 있습니다!</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="implementing-todo-ids"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#implementing-todo-ids" title="Direct link to heading">#</a>Implementing Todo IDs</h3><p>원래 코드에서 새로 추가 된 각 할일은 증가하는 숫자에서 ID 값을 가져옵니다.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-js codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">let</span><span class="token plain"> nextTodoId </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token number" style="color:#AE81FF">0</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">addTodo</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">text</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  type</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;ADD_TODO&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  id</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> nextTodoId</span><span class="token operator" style="color:#F8F8F2">++</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  text</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></code></pre></div><p>지금은 &#x27;addTodo&#x27;액션 생성자가 자동으로 생성되기 때문에 todoSlice는 그렇게하지 않습니다.</p><p>추가 작업을 전달하는 코드가<code>addTodo ({id : 1, text : &quot;Buy milk&quot;})</code>와 같은 새 ID를 전달해야하도록 요구하는 동작을 추가 할 수 있지만, 이는 귀찮은 작업이 됩니다. 호출자가 그 값을 추적해야하는 이유는 무엇입니까? 또한 해당 작업을 전달해야하는 앱의 여러 부분이있는 경우 어떻게해야합니까? 액션 생성자에 해당 로직을 캡슐화하는 것이 좋습니다.</p><p>RTK를 사용하면 작업 개체에서<code>payload</code> 필드가 생성되는 방식을 지정할 수 있습니다. <code>createAction</code>을 단독으로 사용하는 경우 두 번째 인수로 &quot;prepare callback&quot;을 전달할 수 있습니다. 다음과 같이 표시됩니다.</p><blockquote><ul><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/0c9e3b721c209d368d23a70cf8faca8f308ff8df">addTodo ID 생성 구현</a></li></ul></blockquote><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-js codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">let</span><span class="token plain"> nextTodoId </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token number" style="color:#AE81FF">0</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> addTodo </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createAction</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;ADD_TODO&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token parameter">text</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    payload</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> id</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> nextTodoId</span><span class="token operator" style="color:#F8F8F2">++</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> text </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></code></pre></div><p><strong>&#x27;prepare callback&#x27;은 내부에 &#x27;payload&#x27;라는 필드가있는 객체를 반환해야합니다.</strong> 그렇지 않으면 작업의 페이로드가 정의되지 않습니다. 또한 액션과 관련된 추가 메타 데이터를 포함하는 데 사용할 수있는 &#x27;meta&#x27;라는 필드도 포함 할 수 있습니다.</p><p><code>createSlice</code>를 사용하는 경우 자동으로<code>createAction</code>을 호출합니다. 여기에서 페이로드를 사용자 정의해야하는 경우에는 reducer 함수 자체가 아닌<code>reducer</code> 및<code>prepare</code> 함수를 포함하는 객체를<code>reducers</code> 객체에 전달하면됩니다.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-js codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">let</span><span class="token plain"> nextTodoId </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token number" style="color:#AE81FF">0</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> todosSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  name</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;todos&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  initialState</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  reducers</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    addTodo</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token function" style="color:#E6D874">reducer</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> id</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> text </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">push</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> id</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> completed</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token boolean" style="color:#AE81FF">false</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token function" style="color:#E6D874">prepare</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">text</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token keyword" style="color:#F92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> text</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> id</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> nextTodoId</span><span class="token operator" style="color:#F8F8F2">++</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></code></pre></div><p>작동하는지 확인하는 테스트를 추가 할 수 있습니다.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-js codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token function" style="color:#E6D874">describe</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;addTodo&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token function" style="color:#E6D874">it</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;should generate incrementing todo IDs&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> action1 </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">addTodo</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;a&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> action2 </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">addTodo</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;b&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">expect</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action1</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">toEqual</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> id</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token number" style="color:#AE81FF">0</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;a&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">expect</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action2</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">toEqual</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> id</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token number" style="color:#AE81FF">1</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;b&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></code></pre></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="새로운-todos-slice사용"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#새로운-todos-slice사용" title="Direct link to heading">#</a>새로운 Todos Slice사용</h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="root-reducer-업데이트"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#root-reducer-업데이트" title="Direct link to heading">#</a>Root Reducer 업데이트</h3><p>We have a shiny new todos reducer function, but it isn&#x27;t hooked up to anything yet.</p><p>The first step is to go update our root reducer to use the reducer from the todos slice instead of the original reducer. We just need to change the import statement in <code>reducers/index.js</code>:</p><blockquote><ul><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/7b6e005377c856d7415e328387188260330ebae4">todos slice reducer 사용</a></li></ul></blockquote><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-diff codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">import { combineReducers } from &#x27;redux&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">-import todos from &#x27;./todos&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+import todosReducer from &#x27;features/todos/todosSlice&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain">import visibilityFilter from &#x27;./visibilityFilter&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">export default combineReducers({</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">- todos,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+ todos: todosReducer,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token unchanged">  visibilityFilter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged"></span><span class="token plain">})</span></div></code></pre></div><p>While we could have kept the imported function named as <code>todos</code> so that we can use the object literal shorthand with <code>combineReducers</code>, it&#x27;s a little more clear if we name the imported function <code>todosReducer</code> and define the field as <code>todos: todosReducer</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="updating-the-add-todo-component"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#updating-the-add-todo-component" title="Direct link to heading">#</a>Updating the Add Todo Component</h3><p>If we reload the app, we should still see that <code>state.todos</code> is an empty array. But, if we click on &quot;Add Todo&quot;, nothing will happen. We&#x27;re still dispatching actions whose type is <code>&#x27;ADD_TODO&#x27;</code>, while our todos slice is looking for an action type of <code>&#x27;todos/addTodo&#x27;</code>. We need to import the correct action creator and use it in the <code>AddTodo.js</code> file.</p><p>While we&#x27;re at it, there are a couple of other problems with how the <code>AddTodo</code> component is written. First, it&#x27;s currently using a React &quot;callback ref&quot; to read the current text value from the input when you click &quot;Add Todo&quot;. This works, but the standard &quot;React way&quot; to handle form fields is with the &quot;controlled inputs&quot; pattern, where the current field value is stored in the component&#x27;s state.</p><p>Second, the connected component is getting <code>dispatch</code> as a prop. Again, this works, but the normal way to use connect is to <a href="https://react-redux.js.org/using-react-redux/connect-mapdispatch">pass action creator functions to <code>connect</code></a>, and then dispatch the actions by calling the functions that were passed in as props.</p><p>Since we&#x27;ve got this component open, we can fix those issues too. Here&#x27;s what the final version looks like:</p><blockquote><ul><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/d7082409ebaa113b74f6989bf70ee09600f37d0b">Update AddTodo to dispatch the new action type</a></li></ul></blockquote><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-js codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> useState </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> connect </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react-redux&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> addTodo </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;features/todos/todosSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> mapDispatch </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> addTodo </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">AddTodo</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter punctuation" style="color:#F8F8F2">{</span><span class="token parameter"> addTodo </span><span class="token parameter punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">todoText</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> setTodoText</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">onChange</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">e</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">setTodoText</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">target</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">div</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">form</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        onSubmit</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token parameter">e</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          e</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">preventDefault</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          </span><span class="token keyword" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token operator" style="color:#F8F8F2">!</span><span class="token plain">todoText</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">trim</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token keyword" style="color:#F92672">return</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          </span><span class="token function" style="color:#E6D874">addTodo</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">todoText</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          </span><span class="token function" style="color:#E6D874">setTodoText</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">input value</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">todoText</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> onChange</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">onChange</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">/</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">button type</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token string" style="color:#a6e22e">&quot;submit&quot;</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token maybe-class-name">Add</span><span class="token plain"> </span><span class="token maybe-class-name">Todo</span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">button</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">form</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">div</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">default</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">connect</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token keyword null nil" style="color:#F92672">null</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> mapDispatch</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token maybe-class-name">AddTodo</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></code></pre></div><p>todoSlice에서 <code>addTodo</code>액션 생성자를 가져옵니다.
The input is now being handled as a standard &quot;controlled input&quot;, with the text value being stored in the component&#x27;s state. We can use that state text value in the form&#x27;s submit handler.</p><p>Finally, we use the <a href="https://react-redux.js.org/using-react-redux/connect-mapdispatch#defining-mapdispatchtoprops-as-an-object">&quot;object shorthand&quot; form of <code>mapDispatch</code></a> to simplify passing the action creators to <code>connect</code>. The &quot;bound&quot; version of <code>addTodo</code> is passed in to the component as a prop, and it will dispatch the action as soon as we call it.</p><p>입력은 이제 표준 &quot;제어 입력&quot;으로 처리되고 텍스트 값은 구성 요소의 상태에 저장됩니다. 양식의 제출 핸들러에서 해당 상태 텍스트 값을 사용할 수 있습니다.</p><p>마지막으로 <a href="https://react-redux.js.org/using-react-redux/connect-mapdispatch#defining-mapdispatchtoprops-as-an-object">&quot;object shorthand&quot;의 <code>mapDispatch</code></a>의 형식을 사용합니다. 액션 생성자를 &#x27;연결&#x27;에 전달하는 것을 단순화합니다. <code>addTodo</code>의 &quot;바운드&quot;버전은 컴포넌트에 소품으로 전달되며, 호출하자마자 액션을 전달합니다.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="todo-list-업데이트"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#todo-list-업데이트" title="Direct link to heading">#</a>Todo List 업데이트</h3><p><code>TodoList</code> 및<code>VisibleTodoList</code> 구성 요소에는 유사한 문제가 있습니다. 이전<code>toggleTodo</code> 작업 생성기를 사용하고 있으며<code>connect</code> 설정은<code>mapDispatch</code>의 &quot;개체 축약&quot;형식을 사용하지 않습니다. 둘 다 고칠 수 있습니다.</p><blockquote><p>-<a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/b47b2124d6a28386b7461bccb9216682a81edb3e">새로운 토글 액션 유형을 전달하도록 TodoList 업데이트</a></p></blockquote><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-diff codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">// VisibleTodoList.js</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">-import { toggleTodo } from &#x27;../actions&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+import { toggleTodo } from &#x27;features/todos/todosSlice&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">-const mapDispatchToProps = dispatch =&gt; ({</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">- toggleTodo: id =&gt; dispatch(toggleTodo(id))</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-})</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+const mapDispatchToProps = { toggleTodo }</span></div></code></pre></div><p>And with that, we should now be able to add and toggle todos again, but using our new todos slice!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="filters-slice-생성-및-사용"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#filters-slice-생성-및-사용" title="Direct link to heading">#</a>Filters Slice 생성 및 사용</h2><p>todoSlice를 생성하고 UI에 연결 했으므로 이제 필터 선택 로직에 대해서도 동일한 작업을 수행 할 수 있습니다.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="필터-슬라이스-작성"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#필터-슬라이스-작성" title="Direct link to heading">#</a>필터 슬라이스 작성</h3><p>필터 로직은 정말 간단합니다. 액션에있는 것을 반환하여 현재 필터 값을 설정하는 액션이 ​​하나 있습니다. 다음은 전체 조각입니다.</p><blockquote><p>-<a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/b77f4155e3b45bce24d0d0ef6e2f7b0c3bd11ee1">필터 슬라이스 추가</a></p></blockquote><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-js codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> createSlice </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;@reduxjs/toolkit&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token maybe-class-name">VisibilityFilters</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token constant" style="color:#F92672">SHOW_ALL</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;SHOW_ALL&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token constant" style="color:#F92672">SHOW_COMPLETED</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;SHOW_COMPLETED&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token constant" style="color:#F92672">SHOW_ACTIVE</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;SHOW_ACTIVE&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> filtersSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  name</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;visibilityFilters&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  initialState</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token maybe-class-name">VisibilityFilters</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token constant" style="color:#F92672">SHOW_ALL</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  reducers</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">setVisibilityFilter</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">return</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> setVisibilityFilter </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> filtersSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">actions</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">default</span><span class="token plain"> filtersSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">reducer</span></div></code></pre></div><p>원래<code>actions / index.js</code>에 있던<code>VisibilityFilters</code> 열거 형 객체를 복사했습니다. 슬라이스 코드는 하나의 reducer를 생성하고 액션 생성기와 reducer를 내보내면 완료됩니다.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="필터-슬라이스-사용"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#필터-슬라이스-사용" title="Direct link to heading">#</a>필터 슬라이스 사용</h3><p>할일 reducer와 마찬가지로 가시성 reducer를 가져 와서 루트 reducer에 추가해야합니다.</p><blockquote><p>-<a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/623c47b1987914a1d90142824892686ec76c20a1">필터 슬라이스 reducer 사용</a></p></blockquote><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-diff codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">import todosReducer from &#x27;features/todos/todosSlice&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">-import visibilityFilter from &#x27;./visibilityFilter&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+import visibilityFilterReducer from &#x27;features/filters/filtersSlice&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">export default combineReducers({</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token unchanged">  todos: todosReducer,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#F92672">- visibilityFilter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+ visibilityFilter: visibilityFilterReducer</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain">})</span></div></code></pre></div><p>여기에서 사용자가 버튼을 클릭 할 때<code>setVisibilityFilter</code> 액션을 전달해야합니다. 먼저 일관성을 위해 액션 파일 대신 필터 슬라이스 파일에서 내 보낸<code>VisibilityFilter</code> 열거 형을 사용하도록<code>VisibleTodoList.js</code> 및<code>Footer.js</code>를 업데이트해야합니다.</p><p>거기에서 링크 구성 요소는 조금 더 많은 작업이 필요합니다. <code>FilterLink</code>는 현재<code>ownProps.filter</code>의 현재 값을 캡처하는 새 함수를 만들고 있으므로<code>Link</code>는<code>onClick</code>이라는 함수 만 가져옵니다. 이것이 유효한 방법이지만 일관성을 위해<code>mapDispatch</code>의 객체 축약 형을 계속 사용하고 액션을 전달할 때 필터 값을 전달하도록<code>Link</code>를 수정하고 싶습니다.</p><blockquote><p>-<a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/776b39088384513ff68af41039fe5fc5188fe8fb">UI에서 새 필터 액션 사용</a></p></blockquote><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-diff codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">// FilterLink.js</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">-import { setVisibilityFilter } from &#x27;../actions&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+import { setVisibilityFilter } from &#x27;features/filters/filtersSlice&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">-const mapDispatchToProps = (dispatch, ownProps) =&gt; ({</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">- onClick: () =&gt; dispatch(setVisibilityFilter(ownProps.filter))</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-})</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+const mapDispatchToProps = { setVisibilityFilter }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">// Link.js</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">import React from &#x27;react&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">import PropTypes from &#x27;prop-types&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">-const Link = ({ active, children, onClick }) =&gt; (</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+const Link = ({ active, children, setVisibilityFilter, filter }) =&gt; (</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token unchanged">  &lt;button</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#F92672">-    onClick={onClick}</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+    onClick={() =&gt; setVisibilityFilter(filter)}</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token unchanged">    disabled={active}</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged">    style={{</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged">      marginLeft: &#x27;4px&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged">    }}</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged">  &gt;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged">    {children}</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged">  &lt;/button&gt;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged"></span><span class="token plain">)</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">Link.propTypes = {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token unchanged">  active: PropTypes.bool.isRequired,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged">  children: PropTypes.node.isRequired,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#F92672">- onClick: PropTypes.func.isRequired</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+ setVisibilityFilter: PropTypes.func.isRequired,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+ filter: PropTypes.string.isRequired</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain">}</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">export default Link</span></div></code></pre></div><p>다시 말하지만, 이것의 대부분은 RTK와 특별히 관련이 없지만 이 예제 코드에서 권장되는 모범 사례 중 일부를 일관되게 사용하는 것이 좋습니다.</p><p>완료되면 몇 가지 할 일을 추가하고 일부 상태를 전환 한 다음 필터를 전환하여 표시 목록을 변경할 수 있습니다.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="할일-필터링-최적화"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#할일-필터링-최적화" title="Direct link to heading">#</a>할일 필터링 최적화</h2><p><code>VisibleTodoList</code> 구성 요소는 현재<code>getVisibleTodos</code>라는 함수를 사용하여 표시 할 할 일 배열을 필터링하는 작업을 수행합니다. 이것은 <a href="https://redux.js.org/recipes/computing-derived-data">Computing Derived Data</a>의 Redux 문서 페이지에 설명 된 &quot;선택기 기능&quot;입니다. Redux 저장소에서 값을 읽고 사용할 값의 일부 또는 전부를 추출하는 프로세스를 캡슐화합니다.</p><p>그러나 현재 작성된 코드에는 문제가 있습니다. 필터가<code>SHOW_COMPLETED</code> 또는<code>SHOW_ACTIVE</code>로 설정되면 <em> 항상 </em> 호출 될 때마다 <em> 새로운 배열을 반환합니다. <code>mapState</code> 함수에서 사용되기 때문에 _any</em> 액션이 전달 될 때 새로운 배열 참조를 반환합니다.</p><p>이 작은 할일 예제 앱에서는 문제가되지 않습니다. 우리가 가진 유일한 작업은 어쨌든 할 일 목록을 변경하거나 필터링하는 것입니다. 그러나 실제 앱에서는 다른 많은 작업이 전달됩니다. 이 할일 앱에 카운터가 있고 목록이 필터링되는 동안<code> &quot;INCREMENT&quot;</code>가 전달되었다고 상상해보십시오. 우리는 새로운 목록을 생성하고, 아무것도 변경되지 않았더라도<code>TodoList</code>를 다시 렌더링해야합니다.</p><p>이것이 실제 성능 문제는 아니지만 어떻게 행동을 개선 할 수 있는지 보여줄 가치가 있습니다.</p><p>Redux 앱은 일반적으로 &#x27;memoized&#x27;선택기 함수를 정의 할 수있는 &#x27;createSelector&#x27;함수가있는 <a href="https://github.com/reduxjs/reselect">Reselect</a>라는 라이브러리를 사용합니다. 이러한 메모 된 선택기는 입력이 실제로 변경된 경우에만 값을 다시 계산합니다.</p><p>RTK는 Reselect에서<code>createSelector</code> 함수를 다시 내보내므로이를 가져와<code>VisibleTodoList</code>에서 사용할 수 있습니다.</p><blockquote><p>-<a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/4fc943b7111381974f20f74750a114b5e52ce1b2">표시된 할 일을 memoized된 선택기로 변환</a></p></blockquote><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-diff codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">import { connect } from &#x27;react-redux&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+import { createSelector } from &#x27;@reduxjs/toolkit&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain">import { toggleTodo } from &#x27;features/todos/todosSlice&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">import TodoList from &#x27;../components/TodoList&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">import { VisibilityFilters } from &#x27;features/filters/filtersSlice&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">-const getVisibleTodos = (todos, filter) =&gt; {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-  switch (filter) {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-    case VisibilityFilters.SHOW_ALL:</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-      return todos</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-    case VisibilityFilters.SHOW_COMPLETED:</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-      return todos.filter(t =&gt; t.completed)</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-    case VisibilityFilters.SHOW_ACTIVE:</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-      return todos.filter(t =&gt; !t.completed)</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-    default:</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-      throw new Error(&#x27;Unknown filter: &#x27; + filter)</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-  }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-}</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+const selectTodos = state =&gt; state.todos</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+const selectFilter = state =&gt; state.visibilityFilter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+const selectVisibleTodos = createSelector(</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+  [selectTodos, selectFilter],</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+  (todos, filter) =&gt; {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+    switch (filter) {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+      case VisibilityFilters.SHOW_ALL:</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+        return todos</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+      case VisibilityFilters.SHOW_COMPLETED:</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+        return todos.filter(t =&gt; t.completed)</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+      case VisibilityFilters.SHOW_ACTIVE:</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+        return todos.filter(t =&gt; !t.completed)</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+      default:</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+        throw new Error(&#x27;Unknown filter: &#x27; + filter)</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+    }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+  }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+)</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">const mapStateToProps = state =&gt; ({</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">- todos: getVisibleTodos(state.todos, state.visibilityFilter)</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+ todos: selectVisibleTodos(state)</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain">})</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">const mapDispatchToProps = { toggleTodo }</span></div></code></pre></div><p>먼저 RTK에서<code>createSelector</code>를 가져오고<code>state</code> 인수에서<code>todos</code> 및<code>visibilityFilter</code> 필드를 가져 오는 두 개의 한 줄 선택기 함수를 정의합니다.</p><p>그런 다음<code>createSelector</code>를 호출하고 &quot;입력 선택자&quot;배열에있는 두 개의 작은 선택자 함수를 전달합니다. <code>createSelector</code>는이를 호출하고 반환 값을 가져 와서 우리가 정의한 &quot;출력 선택자&quot;에 전달하면 필터링을 수행하고 최종 결과를 반환 할 수 있습니다.</p><p>이것이 정의되고 사용되는 방법에 몇 가지 작은 변화가 있습니다. 선택기 함수에 원하는 이름을 지정할 수 있지만<code>selectX</code>는<code>getX</code>보다 일반적인 명명 규칙입니다. 또한 입력 선택기가 필요한 값을 읽는 것을 처리하므로 &#x27;state&#x27;를 유일한 인수로 사용하여 &#x27;selectVisibleTodos (state)&#x27;를 호출 할 수 있습니다.</p><p>앱을 다시 실행하면 필터링 로직이 <em>should</em> UI에서 볼 수있는 것과 동일하게 작동합니다.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="정리"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#정리" title="Direct link to heading">#</a>정리</h2><p>이것이 실제 변환 작업의 끝입니다. 이제 더 이상 사용되지 않는 액션 및 리듀서 파일이 많이 있으므로 프로젝트를 정리하기 위해 삭제해야합니다.</p><p><code>actions / index.js</code>,<code>reducers / todos.js</code>,<code>reducers / visibilityFilter.js</code> 및 관련 테스트 파일을 안전하게 제거 할 수 있습니다.</p><p>또한 모든 구성 요소 파일을 일치하는 기능 폴더로 이동하여 &quot;유형별 폴더&quot;구조에서 &quot;기능 폴더&quot;구조로 완전히 전환 할 수 있습니다.</p><blockquote><p>-<a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/fbc0b965949e082748b8613b734612226ffe9e94">사용하지 않는 액션 및 reducer 파일 제거</a>
-<a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/138cc162b1cc9c64ab67fae0a1171d07940414e6">컴포넌트를 feature 폴더로 통합</a></p></blockquote><p>그렇게하면 최종 소스 코드 구조는 다음과 같습니다.</p><ul><li><code>/src</code><ul><li><code>/components</code><ul><li><code>App.js</code></li></ul></li><li><code>/features</code><ul><li><code>/filters</code><ul><li><code>FilterLink.js</code></li><li><code>filtersSlice.js</code></li><li><code>Footer.js</code></li><li><code>Link.js</code></li></ul></li><li><code>/todos</code><ul><li><code>AddTodo.js</code></li><li><code>Todo.js</code></li><li><code>TodoList.js</code></li><li><code>todosSlice.js</code></li><li><code>todosSlice.spec.js</code></li><li><code>VisibleTodoList.js</code></li></ul></li></ul></li><li><code>/reducers</code><ul><li><code>index.js</code></li></ul></li><li><code>index.js</code></li></ul></li></ul><p>모든 사람이 &quot;유지 관리가 가능한&quot;폴더 구조를 만드는 것에 대한 선호도가 다르지만 전반적으로 그 결과는 매우 일관되고 따르기 쉽습니다.</p><p>이제 실제 코드의 최종 버전을 살펴 보겠습니다!</p><iframe src="https://codesandbox.io/embed/rtk-convert-todos-example-uqqy3?fontsize=14&amp;hidenavigation=1&amp;module=%2Fsrc%2Ffeatures%2Ftodos%2FtodosSlice.js&amp;theme=dark&amp;view=editor" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden" title="rtk-convert-todos-example" allow="geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin"></iframe><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="요약"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#요약" title="Direct link to heading">#</a>요약</h2><p>이 자습서에서는 다음을 확인했습니다.</p><p>-패키지 추가, &quot;슬라이스&quot;파일 작성, React 컴포넌트에서 액션 디스패치 등 일반적인 React 애플리케이션에서 RTK를 사용하는 방법</p><ul><li>&quot;변경 가능한&quot;reducer 사용, 작업 페이로드 준비 및 선택기 함수 작성 방법
-<code>mapDispatch</code>의 &quot;object shorthand&quot;형식을 사용하는 것과 같이 React-Redux 코드를 단순화하는 몇 가지 기술
-코드 구성을 위해 &quot;기능 폴더&quot;구조를 사용하는 예.</li></ul><p>실제로 이러한 방법을 실제로 사용하는 방법을 설명하는 데 도움이 되었기를 바랍니다.</p><p>곧 제공 될 예정 : 고급 자습서, 비동기 데이터 가져 오기를 수행하고 TypeScript를 사용하는 앱에서 RTK를 사용하는 방법을 살펴볼 것입니다.</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/redux-toolkit/tutorials/basic-tutorial"><h5 class="pagination-nav__link--sublabel">Previous</h5><h4 class="pagination-nav__link--label">« 기본 튜토리얼</h4></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/redux-toolkit/tutorials/advanced-tutorial"><h5 class="pagination-nav__link--sublabel">Next</h5><h4 class="pagination-nav__link--label">Advanced Tutorial »</h4></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#redux-todos-예제-리뷰" class="contents__link">Redux Todos 예제 리뷰</a></li><li><a href="#초기-단계" class="contents__link">초기 단계</a><ul><li><a href="#project에-redux-toolkit-추가하기" class="contents__link">Project에 Redux Toolkit 추가하기</a></li><li><a href="#store에서-configurestore를-사용하도록-수정" class="contents__link">Store에서 <code>configureStore</code>를 사용하도록 수정</a></li></ul></li><li><a href="#todo-slice만들기" class="contents__link">Todo Slice만들기</a><ul><li><a href="#slices-이해하기" class="contents__link">Slices 이해하기</a></li><li><a href="#기존의-todos-reducer" class="contents__link">기존의 Todos Reducer</a></li><li><a href="#slice-reducer작성" class="contents__link">Slice Reducer작성</a></li><li><a href="#updating-the-todos-tests" class="contents__link">Updating the Todos Tests</a></li><li><a href="#implementing-todo-ids" class="contents__link">Implementing Todo IDs</a></li></ul></li><li><a href="#새로운-todos-slice사용" class="contents__link">새로운 Todos Slice사용</a><ul><li><a href="#root-reducer-업데이트" class="contents__link">Root Reducer 업데이트</a></li><li><a href="#updating-the-add-todo-component" class="contents__link">Updating the Add Todo Component</a></li><li><a href="#todo-list-업데이트" class="contents__link">Todo List 업데이트</a></li></ul></li><li><a href="#filters-slice-생성-및-사용" class="contents__link">Filters Slice 생성 및 사용</a><ul><li><a href="#필터-슬라이스-작성" class="contents__link">필터 슬라이스 작성</a></li><li><a href="#필터-슬라이스-사용" class="contents__link">필터 슬라이스 사용</a></li></ul></li><li><a href="#할일-필터링-최적화" class="contents__link">할일 필터링 최적화</a></li><li><a href="#정리" class="contents__link">정리</a></li><li><a href="#요약" class="contents__link">요약</a></li></ul></div></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/redux-toolkit/introduction/quick-start">Quick Start</a></li><li class="footer__item"><a class="footer__link-item" href="/redux-toolkit/api/configureStore">API Reference</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="http://stackoverflow.com/questions/tagged/redux">Stack Overflow</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://discord.gg/0ZcbPKXt5bZ6au5t">Discord</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://www.github.com/reduxjs/redux-toolkit">GitHub</a></li><li class="footer__item">
                <a href="https://www.netlify.com">
                  <img src="https://www.netlify.com/img/global/badges/netlify-light.svg" alt="Deploys by Netlify">
                </a>
              </li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><img class="footer__logo" alt="Redux Logo" src="/redux-toolkit/img/redux_white.svg"></div>Copyright (c) 2015-present Dan Abramov and the Redux documentation authors.</div></div></footer>
</div>

<script src="/redux-toolkit/styles.65c09200.js"></script>

<script src="/redux-toolkit/runtime~main.0722f1cd.js"></script>

<script src="/redux-toolkit/main.bae73ed5.js"></script>

<script src="/redux-toolkit/1.188bb098.js"></script>

<script src="/redux-toolkit/2.46003221.js"></script>

<script src="/redux-toolkit/26.f1fc65f0.js"></script>

<script src="/redux-toolkit/b769c63f.a0c93f25.js"></script>

<script src="/redux-toolkit/17896441.dec4baf3.js"></script>

<script src="/redux-toolkit/b7bc07b1.97f43881.js"></script>


</body>
</html>